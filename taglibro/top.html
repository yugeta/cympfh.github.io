<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>cympfh/taglibro/top</title>
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="css/h1.css">
    <style>
      section {
        border: 1px #f0f0f0 solid;
        background-color: #f0f0f0;
        margin-top: 2em;
        padding: 1em;
        padding-bottom: 2em;
      }
    </style>
  </head>
  <body>
<section>
<h1 id="tue-feb-10-060332-jst-2015">Tue Feb 10 06:03:32 JST 2015</h1>
<p>ネットサーフィンという楽しみはTwitterで流れてくるurlを踏むという作業に移った。</p>
<ol class="incremental" type="1">
<li>Twitter のタイムライン</li>
<li><a href="http://www.sciencecomlabo.jp/supernatural_power/">不思議現象 | 疑似科学とされるものの科学性評定サイト</a></li>
<li><a href="http://www50.atwiki.jp/ufowiki/">ufowiki @ 東京大学UFO研究会 - トップページ</a></li>
<li><a href="http://www.02.246.ne.jp/~kasahara/psycho/denialofhappiness1.html">幸福否定のさまざまなパターン</a></li>
</ol>
<p>「幸福否定」なるものは、笠原敏雄という男が、<br>一人で研究している心理学的な理論であるらしく、<br>いわゆる、超心理学であろう。<br>つまり、心理学の体系には仲間に入れてもらえてない分野。<br>そらまあ、「幸福否定」なんて言葉はその男しか使っていないようであるし。</p>
<blockquote>
<p>たとえばＡと、その逆のＢというふたつの選択肢がある場合、本当はＡを選びたいのに、実際にはそれを選ぶことができず、即座にＢの方を選んでしまうというのである。</p>
</blockquote>
<p>分かるなあ。と思いつつ、既存の心理学で説明できそうな現象である。</p>
<p>ところで私は歯医者に行かなければならないのである。<br>親知らずが水平方向に生えているらしい。<br>レントゲン写真でありありと見せられてしまった。<br>しかしそれは、もう、これ以上生えるのを止めて僕を苦しめないのではないかという、<br>そういう希望がまだ捨てられないからだ。<br>そのまま放っておくと辛いぞという親からの写実的な脅しをまだ私は鼻で笑っている。</p>
<p>本気で自分を楽しませよう。<br>散歩してて、本屋にふらっと入って、マンガを数冊買う。<br>これは自分を楽しませることだ。<br>金がかかりすぎるのと、<br>一回読み終えると、すぐ飽きてしまう。<br>(それでもたまにアタリの本だったりすると、大変な幸福だから止められない)</p>
<p>お金がかからず、もっと長く楽しめて、<br>肉体にも精神にも健全な、楽しませ方に苦心しよう。</p>
</section>
<section>
<h1 id="sat-jan-31-032628-jst-2015">Sat Jan 31 03:26:28 JST 2015</h1>
<p>集中して作業できる時間帯は朝の5時から朝の9時くらいまで。 起きたら夕方という生活は間違いなく、 自分を混乱させる。</p>
<p>めったに逢わない人間と逢って、話をしたら、 最近読んでいる百合のマンガで趣味が一致したのが嬉しかった。 どちらかと言えばマイナーなジャンルのものだったので、 余計にだった。</p>
</section>
<section>
<h1 id="thu-jan-29-052554-jst-2015">Thu Jan 29 05:25:54 JST 2015</h1>
<h2 id="環境を可愛らしくすることでしか自分を表現できない">環境を可愛らしくすることでしか自分を表現できない</h2>
<p><code>i3wm</code> -&gt; <code>terminator (特にこだわりなし)</code> -&gt; <code>zsh</code> -&gt; <code>gnu screen</code> -&gt; <code>vim</code></p>
<p>可愛さをアピールするチャンスはいくらでもある</p>
<figure>
<img src="img/150129a.png"><figcaption></figcaption>
</figure>
<p>水色系で可愛いを目指した<br>黒を背景なのを前提にしているのでピンク色はなんか汚く見えた</p>
<p><em>N.B.</em><br>ターミナルの背景を半透明にして、<code>feh</code>で壁紙画像を出してるのだけど、<br>キャプチャだとなんだか汚く見える問題</p>
<figure>
<img src="img/150129b.png"><figcaption></figcaption>
</figure>
<p>vim は黄色。水色とマッチしてない<br>これは解決すべき問題</p>
<figure>
<img src="img/150129c.png"><figcaption></figcaption>
</figure>
<p>ノーマルモードと挿入モードでハイライトが変わる</p>
<hr>
<p>cympfh@gmail.com</p>
</section>
<section>
<h1 id="sat-jan-24-020624-jst-2015">Sat Jan 24 02:06:24 JST 2015</h1>
<p>Rust 1.0.0-alpha が出たってのに nightly のドキュメントを読んで遊んでた. 触感として、速度は <code>C++</code> &gt; <code>Rust -O</code> &gt; <code>Haskell -O3</code> というところ.</p>
<p>今改めて, 新しいバージョンの方を読んでる.</p>
<p><a href="http://doc.rust-lang.org/1.0.0-alpha/book/">Rust 1.0.0-alpha Book</a></p>
</section>
<section>
<h1 id="fri-jan-23-024136-jst-2015">Fri Jan 23 02:41:36 JST 2015</h1>
<p>AndroidからPCを操作したくて、 Chrome-remote-desktop は、 <code>PC -- PC</code> も、 <code>PC -- Android</code> (AndroidからPCを操作) も出来るらしいので、 インストールを試みた。</p>
<p>結果、できてないです。</p>
<h2 id="install-chrome-remote-desktop-into-debian-wheezy">install Chrome-remote-desktop into Debian Wheezy</h2>
<p>Chromeの上の拡張 &quot;chrome-remote-desktop&quot; を起動. &quot;Share this computer to another...&quot; を選択すると、 <code>*.deb</code> のダウンロードが始まる</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> dpkg -i *.deb</code></pre>
<p>すると、依存関係が解決できないと言われた。 (<code>xvfb</code>, <code>gksu</code>, <code>xbase-clients</code>, <code>python-psutil</code> に依存してるらしいが、 そんなのは存在しないと言われた。)</p>
<h3 id="レポジトリの追加">レポジトリの追加</h3>
<p>Chrome-remote-desktop は、 以下のレポジトリで提供されてるらしい。 きっと必要な依存もその中にあるのだろう。</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">echo</span> <span class="st">&quot;deb http://dl.google.com/linux/chrome-remote-desktop/deb/ stable main&quot;</span> <span class="kw">\</span>
<span class="kw">|</span> <span class="kw">sudo</span> <span class="kw">tee</span> /etc/apt/sources.list.d/chromeos.list</code></pre>
<p><code>apt-get update</code> すると、以下のように怒られた。</p>
<pre><code>W: GPG error: http://dl.google.com stable Release: The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY A040830F7FAC5991</code></pre>
<h3 id="apt-key-リポジトリの公開鍵の追加">apt-key (リポジトリの公開鍵の追加)</h3>
<p>リポジトリを追加するのに今までこんな事やったことなかったんだけどなあ</p>
<ul class="incremental">
<li><a href="http://www.yukun.info/blog/2014/01/linux-apt-get-gpg-error-no-pubkey.html">Linux: apt-get 時の GPG error (NO_PUBKEY) の解決例</a></li>
</ul>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="ot">KEY=</span>A040830F7FAC5991
gpg --keyserver subkeys.pgp.net --recv-keys <span class="ot">$KEY</span>
gpg -a --export <span class="ot">$KEY</span> <span class="kw">|</span> <span class="kw">sudo</span> apt-key add -
<span class="kw">sudo</span> apt-get update</code></pre>
<p>エラー無くアップデートできた。</p>
<h3 id="インストール">インストール</h3>
<p>レポジトリ追加さえすればインストールはできる。</p>
<p>先ほどの <code>*.pkg</code> があれば、改めて、</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> dpkg -i *.deb</code></pre>
<p>でいいし、</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> apt-get <span class="kw">install</span> chrome-remote-desktop</code></pre>
<p>でも、インストールできる。</p>
<h3 id="起動">起動</h3>
<pre><code>sudo /etc/init.d/chrome-remote-desktop start</code></pre>
<p>で出来るようだけど、 起動して、Chrome で確認しても、 インストールしろというメッセージしか表示されない。</p>
<h2 id="諦めた">諦めた</h2>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> apt-get -y remove chrome-remote-desktop
<span class="kw">sudo</span> apt-get -y autoremove</code></pre>
</section>
<section>
<h1 id="wed-jan-7-202757-jst-2015">Wed Jan 7 20:27:57 JST 2015</h1>
<p>サークルのためのwebページとして、 単にドメイン名を短く覚え易く見た目に可愛らしさとクールさがあるものが欲しいという理由で、 お名前.comでドメインをとりあえず一年契約し、 一緒に共有サーバ契約すると、お試しということであろうが、 3ヶ月1円だそうなので、それらを申し込んだ。 次の日にコンビニで3981円と手数料を支払って3時間か4時間後には使えるようになった。</p>
<p>この共有サーバというのがftp接続した用意してなくて、 この時代にftpはさすがに古臭すぎる。 github pages の便利さを思い知った。</p>
<p>静的なものしか置けないことと、 pushしてから実際に更新されるまでにタイムラグがあるというデメリットはあるけども。 (タイムラグについては、頻繁に更新されるページほど短く、めったに更新されない、特に作りたてのページは長いという経験則がある)</p>
<p>どうせ、手元にあるファイル全部をrecursiveにputする、という操作しかしないのに。 いちいち新しいファイルで上書きしますか？などと聞いてくるftpクライアントは馬鹿みたいだ。 gitのように勝手に差分を見て、それだけを送ってほしい。</p>
<p><a href="http://blog.textfile.org/20141014/github/">静的サイトをgithub.ioでホスティングし、独自ドメインでアクセスする - 結城浩のブログ</a></p>
<p>これで良いのではないか。 試してみよう。 (下に追記アリ)</p>
<hr>
<ul class="incremental">
<li><a href="http://alice.fail/">alice.fail</a></li>
<li><a href="http://alice-lips.github.io/">alice-lips.github.io</a></li>
</ul>
<hr>
<h1 id="追記-wed-jan-14-190146-jst-2015">追記; Wed Jan 14 19:01:46 JST 2015</h1>
<ol class="incremental" type="1">
<li><a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/">Setting up a custom domain with GitHub Pages - User Documentation</a></li>
<li><a href="https://help.github.com/articles/tips-for-configuring-an-a-record-with-your-dns-provider/">Tips for configuring an A record with your DNS provider - User Documentation</a></li>
</ol>
<p>順に従うだけ。</p>
<p>github pages に <code>CNAME</code> を置いた時点では、<code>hoge.github.io</code> に行くと CNAME に書いた url に飛ばされるだけになる。 DNSの設定が本当に反映されるまでに少しタイムラグがあって、(本当にその設定が正しいのかも分からないのに) 多少手間取ったけど。</p>
<p>私の場合はお名前.comという一部で評判の良くないところを使ってるので、そのwebサイトの上で設定を以下のように行った。 こういうwebサービスは名称や使ってる言葉がころころ変わったりして、 役に立つかわからないけれども、以下のように。</p>
<figure>
<img src="img/150107.png"><figcaption></figcaption>
</figure>
<p>下の2つを私が追加したのであって、このVALUEには、先に上げた2つ目の<a href="https://help.github.com/articles/tips-for-configuring-an-a-record-with-your-dns-provider/">ページ</a> に載っているIPアドレスを指定している。 このIPも、去年に一度変更があったらしいので、 もしかしたら将来も、チェックする必要が出てくるかもしれない。</p>
<p>github pages の<a href="https://github.com/alice-lips/alice-lips.github.io/settings">設定のページ</a> の方でも以下のメッセージが登場するようになる。</p>
<figure>
<img src="img/150107b.png"><figcaption></figcaption>
</figure>
<p>IPアドレスが変更するなどの警告も、ここに出るようである。</p>
</section>
<section>
<h1 id="tue-jan-6-014147-jst-2015">Tue Jan 6 01:41:47 JST 2015</h1>
<p>ちょうど去年の年跨ぎは、ゆゆ式を見ながら実験用プログラムのデバグをしていたのを覚えている。 試しにその日の日記を開いてみよう。 3話を見てたらしい。 今度もそのつもりだったのだが、 都合悪くゆゆ式を見られる環境を持って行けず、 つまらない過ごし方をしていた。</p>
<p>およそ二週間ぶりに東京の家に戻ると、 ネットが死んでいた。 ルーターとハブとがあるわけで、 各々を主に再起動したり、 ほとんど意味のないような設定の変更をしたり試みて、 諦めて、 サポートセンターにメールして寝て起きて、 メールにあるとおりに、 ただし 昨夜もやったように、 再起動してもっかい接続を試みたら接続できた。</p>
<p>メールには、「12/19から接続をしてきた形跡がない。IDが間違えてるか、 さもなくば、ハブを殺してルータを殺した後にルータを起動さしてハブを起動させよ」とあったのでそのとおりにした。 でもそんなことは昨夜もやっていた。 実際、最後に接続をしたのは、12/21のはずだし、 きっと何か隠してるに違いないと思ってる。</p>
<p>あとなにか書くことはあるかな。</p>
<p>初詣は去年と全く同じ神社に参った。</p>
<p>豊郷小学校に見学に行った。 写真をいくらか撮ってきたので、どこかネットの上に公開したい。 ネットの上に置くことは、 自分がネットさえあればどこからでも見られるのと、 また、人に見せていちいち自慢するためである。</p>
<p>月曜日の午前に取っていた一つの講義、 あまりに出席していなくて、諦めている。 今からでも単位をただ取得することはできると思うけれど、 あまり意欲的ではない。</p>
<p>ArchLinux の方が、気づいたら mount 周りが怪しくなってきた。 すなわち、mount したファイルの権限が <code>rw-------</code> になってるし、 root でも一切書き込めない。 というのは、外付けHDD (-t ntfs) であって、 試しに小さなUSBメモリだと、root 権限で書き込めた。 どうにも怪しい。 自分には debian のほうが優しい。</p>
<hr>
<p>記事の検索、 大体使う度に不満が出て、根本的な部分 (名詞の抽出と、{2,3}-gram) はこれ以上工夫する余裕はないけど、 閾値のとり方だけ時々変えてる。</p>
<p>すなわち、 簡単に、記事ごとにスコアを付けさせて、 降順に並べるなら検索機能だけど、 関連記事だけを選び出すこと (filter) をしたいので、 適当な閾値を定めて、 それより上の記事だけを選択することをする。</p>
<p>今までは、<code>(スコアの最大値) / 10</code> を閾値としてた。 これは随分緩い結果になったけど、 欲しいのが手に入らないよりは、ノイズがあってもすべてを網羅してるのがいいと思ったから. ただカタカナ語で調べると無視できないノイズの量になった. <code>(スコアの二番目の最大値) / 2</code> と変更した。 触った感じよさげだ。 さすがに適合率を測るプログラムは書く気にならない。</p>
</section>
<section>
<h1 id="sun-dec-7-190935-jst-2014">Sun Dec 7 19:09:35 JST 2014</h1>
<h2 id="in-nodejs-let-require-reload">In nodejs let require reload</h2>
<p>require は二度と同じ物を読み込まないようにキャッシュを持っているために、 途中にファイルの中身に変更が生じても、 ただ require するだけでは中身は変わらない。</p>
<h3 id="terminal-a">terminal A</h3>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cat</span> datum.json
<span class="kw">{</span>
    <span class="st">&quot;message&quot;</span>: <span class="st">&quot;wait&quot;</span>
<span class="kw">}</span></code></pre>
<h3 id="terminal-b">terminal B</h3>
<pre class="coffee"><code>coffee&gt; require &#39;./datum&#39;
{ message: &#39;wait&#39; }
coffee&gt; # ここで terminal A に戻って中身を変更する
coffee&gt; require &#39;./datum&#39;
{ message: &#39;wait&#39; } # キャッシュした結果を返すだけ</code></pre>
<p>動的に中身が変わるファイルをリアルタイムに読み込みたいときや、 あるいは開発中のREPLでの動作確認で困る。</p>
<p>キャッシュは <code>require.cache</code> に連想配列として持っている。 連想配列のキーは 読み込むファイルの絶対パスである。</p>
<p>拡張子の省略を許したパスから絶対パスへの変換は <code>require.resolve</code> で行われる</p>
<pre class="coffee"><code>coffee&gt; require &#39;./datum&#39;
{ message: &#39;wait&#39; }
coffee&gt; delete require.cache[require.resolve &#39;./datum&#39;]
true
coffee&gt; require &#39;./datum&#39;
{ message: &#39;ready&#39; }</code></pre>
</section>
<section>
<h1 id="年-11月30日-日曜日-17時15分19秒-jst">2014年 11月30日 日曜日 17時15分19秒 JST</h1>
<h2 id="code-runner">CODE RUNNER</h2>
<h3 id="test.coffee">test.coffee</h3>
<pre class="sourceCode coffee"><code class="sourceCode coffee">fs <span class="kw">=</span> require <span class="st">&#39;fs&#39;</span>
<span class="kw">{</span>exec<span class="kw">}</span> <span class="kw">=</span> require <span class="st">&#39;child_process&#39;</span>
it <span class="kw">=</span> require <span class="st">&#39;./it.json&#39;</span>

N <span class="kw">=</span> <span class="kw">(+</span>process<span class="kw">.</span>argv<span class="kw">[</span><span class="dv">3</span><span class="kw">]</span> <span class="kw">or</span> <span class="dv">60</span><span class="kw">)</span>

ms <span class="kw">=</span> <span class="kw">[]</span>

curl <span class="kw">=</span> <span class="fu">(url, cont) -&gt;</span>
  exec <span class="st">&quot;curl \&#39;</span><span class="ch">#{</span>url<span class="ch">}</span><span class="st">\&#39; |nkf&quot;</span><span class="kw">,</span> <span class="fu">(err, out) -&gt;</span>
    <span class="kw">throw</span> err <span class="kw">if</span> err
    cont out <span class="kw">if</span> cont

URL <span class="kw">=</span> <span class="st">&quot;https://game.coderunner.jp/&quot;</span>
token <span class="kw">=</span> <span class="st">&#39;CDR2YBS99ZXWOQSQUERT71KL18ORJV6K&#39;</span>
time_lag <span class="kw">=</span> <span class="dv">1100</span>

<span class="co"># who am i?</span>
info <span class="kw">=</span> <span class="kw">{}</span>
ami <span class="kw">=</span> <span class="fu">(cont) -&gt;</span>
  curl <span class="st">&quot;</span><span class="ch">#{</span>URL<span class="ch">}</span><span class="st">info.json?token=</span><span class="ch">#{</span>token<span class="ch">}</span><span class="st">&quot;</span><span class="kw">,</span> <span class="fu">(result) -&gt;</span>
    <span class="kw">try</span>
      info <span class="kw">=</span> JSON<span class="kw">.</span>parse result
      cont info <span class="kw">if</span> cont
    <span class="kw">catch</span>
      <span class="co">#passing</span>

summon <span class="kw">=</span> <span class="fu">(id, cont) -&gt;</span>
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;summon </span><span class="ch">#{</span>id<span class="ch">}</span><span class="st">&quot;</span>
  curl <span class="st">&quot;</span><span class="ch">#{</span>URL<span class="ch">}</span><span class="st">summon?monster=</span><span class="ch">#{</span>id<span class="ch">}</span><span class="st">&amp;token=</span><span class="ch">#{</span>token<span class="ch">}</span><span class="st">&quot;</span><span class="kw">,</span> <span class="fu">(result) -&gt;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;result: </span><span class="ch">#{</span>result<span class="ch">}</span><span class="st">&quot;</span>
    cont <span class="kw">(</span>result <span class="kw">is</span> <span class="st">&quot;OK&quot;</span><span class="kw">)</span>

<span class="co"># monsters scores info</span>
reload <span class="kw">=</span> <span class="fu">(cont) -&gt;</span>
  exec <span class="st">&quot;curl https://game.coderunner.jp/scorelist&quot;</span><span class="kw">,</span> <span class="fu">(_, out) -&gt;</span>
    ls <span class="kw">=</span> out<span class="kw">.</span>split<span class="kw">(</span><span class="st">&#39;\r\n&#39;</span><span class="kw">).</span>slice <span class="dv">0</span><span class="kw">,</span> <span class="kw">-</span><span class="dv">1</span>
    ms <span class="kw">=</span> ls<span class="kw">.</span>map <span class="fu">(x) -&gt;</span> x <span class="kw">|</span> <span class="dv">0</span>
    cont ms

ok <span class="kw">=</span> <span class="fu">(m_id) -&gt;</span>
  ls1 <span class="kw">=</span> it<span class="kw">[</span>m_id<span class="kw">].</span>required
  ls2 <span class="kw">=</span> info<span class="kw">.</span>stone
  <span class="kw">for</span> x<span class="kw">,</span> i <span class="kw">in</span> ls1
    <span class="kw">if</span> x <span class="kw">&gt;</span> ls2<span class="kw">[</span>i<span class="kw">]</span>
      <span class="kw">return</span> <span class="ot">false</span>
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;ok&quot;</span>
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;req: </span><span class="ch">#{</span>ls1<span class="ch">}</span><span class="st">&quot;</span>
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;pos: </span><span class="ch">#{</span>ls2<span class="ch">}</span><span class="st">&quot;</span>
  <span class="kw">return</span> <span class="ot">true</span>

loop_summon <span class="kw">=</span> <span class="fu">-&gt;</span>
  ami <span class="fu">-&gt;</span>
    reload <span class="fu">(ms) -&gt;</span>

      ms <span class="kw">=</span> ms<span class="kw">.</span>slice<span class="kw">(</span><span class="dv">0</span><span class="kw">,</span> N<span class="kw">)</span>
      ls <span class="kw">=</span> ms<span class="kw">.</span>map<span class="kw">(</span><span class="fu">(score, idx) -&gt;</span> <span class="kw">[</span>idx<span class="kw">,</span> score<span class="kw">])</span>
        <span class="kw">.</span>sort <span class="fu">(a,b) -&gt;</span> b<span class="kw">[</span><span class="dv">1</span><span class="kw">]</span> <span class="kw">-</span> a<span class="kw">[</span><span class="dv">1</span><span class="kw">]</span>

      rec <span class="kw">=</span> <span class="fu">(idx) -&gt;</span>
        <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;rec : </span><span class="ch">#{</span>idx<span class="ch">}</span><span class="st">&quot;</span>
        <span class="kw">if</span> idx <span class="kw">&lt;</span> ls<span class="kw">.</span>length
          <span class="kw">if</span> ok idx
            summon ls<span class="kw">[</span>idx<span class="kw">][</span><span class="dv">0</span><span class="kw">],</span> <span class="fu">(b) -&gt;</span>
              <span class="kw">if</span> b
                <span class="ot">setTimeout</span> <span class="kw">(</span><span class="fu">-&gt;</span> rec idx<span class="kw">),</span> time_lag
              <span class="kw">else</span>
                <span class="ot">setTimeout</span> <span class="kw">(</span><span class="fu">-&gt;</span> rec idx <span class="kw">+</span> <span class="dv">1</span><span class="kw">),</span> time_lag
          <span class="kw">else</span>
            <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;ng&quot;</span>
            rec idx <span class="kw">+</span> <span class="dv">1</span>
        <span class="kw">else</span>
          do loop_summon

      rec <span class="dv">0</span>

trade <span class="kw">=</span> <span class="fu">(take, give, num) -&gt;</span>
  <span class="ot">console</span><span class="kw">.</span>warn <span class="st">&quot;</span><span class="ch">#{</span>URL<span class="ch">}</span><span class="st">trade?token=</span><span class="ch">#{</span>token<span class="ch">}</span><span class="st">&amp;in=</span><span class="ch">#{</span>take<span class="ch">}</span><span class="st">&amp;out=</span><span class="ch">#{</span>give<span class="ch">}</span><span class="st">&amp;num=</span><span class="ch">#{</span>num<span class="ch">}</span><span class="st">&quot;</span>
  curl <span class="st">&quot;</span><span class="ch">#{</span>URL<span class="ch">}</span><span class="st">trade?token=</span><span class="ch">#{</span>token<span class="ch">}</span><span class="st">&amp;in=</span><span class="ch">#{</span>take<span class="ch">}</span><span class="st">&amp;out=</span><span class="ch">#{</span>give<span class="ch">}</span><span class="st">&amp;num=</span><span class="ch">#{</span>num<span class="ch">}</span><span class="st">&quot;</span><span class="kw">,</span> <span class="fu">(out) -&gt;</span>
    <span class="ot">console</span><span class="kw">.</span>warn out <span class="kw">if</span> out

loop_trade <span class="kw">=</span> <span class="fu">-&gt;</span>
  base <span class="kw">=</span> <span class="dv">20</span>
  cx <span class="kw">=</span> <span class="dv">24</span> <span class="kw">-</span> base <span class="kw">+</span> <span class="dv">1</span>
  ami <span class="fu">(o) -&gt;</span>
    ls <span class="kw">=</span> o<span class="kw">.</span>stone<span class="kw">[</span>base <span class="kw">..</span> <span class="dv">24</span><span class="kw">]</span>
    mx <span class="kw">=</span> <span class="kw">-</span><span class="dv">1</span>
    mi <span class="kw">=</span> <span class="kw">-</span><span class="dv">1</span>
    <span class="kw">for</span> m<span class="kw">,</span> i <span class="kw">in</span> ls
      <span class="kw">if</span> mx <span class="kw">&lt;</span> m
        mx <span class="kw">=</span> m
        mi <span class="kw">=</span> i
    <span class="ot">console</span><span class="kw">.</span>log ls
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;mx, mi = &quot;</span><span class="kw">,</span> mx<span class="kw">,</span> mi
    rec <span class="kw">=</span> <span class="fu">(idx) -&gt;</span>
      <span class="kw">if</span> idx <span class="kw">&gt;=</span> ls<span class="kw">.</span>length <span class="kw">or</span> <span class="kw">(</span>idx <span class="kw">&gt;</span> <span class="dv">10</span><span class="kw">)</span>
        <span class="kw">return</span>
      <span class="kw">if</span> idx <span class="kw">isnt</span> mi
        trade <span class="kw">(</span>base <span class="kw">+</span> idx<span class="kw">),</span> <span class="kw">(</span>base <span class="kw">+</span> mi<span class="kw">),</span> <span class="kw">(</span>mx <span class="kw">/</span> cx <span class="kw">|</span> <span class="dv">0</span><span class="kw">)</span>
      <span class="ot">setTimeout</span> rec<span class="kw">,</span> time_lag<span class="kw">,</span> <span class="kw">(</span>idx <span class="kw">+</span> <span class="dv">1</span><span class="kw">)</span>
    rec <span class="dv">0</span>

seco_trade <span class="kw">=</span> <span class="fu">-&gt;</span>
  list <span class="kw">=</span> <span class="kw">[]</span>
  <span class="kw">for</span> i <span class="kw">in</span> <span class="kw">[</span><span class="dv">0</span> <span class="kw">..</span> <span class="dv">16</span><span class="kw">]</span>
    <span class="kw">for</span> j <span class="kw">in</span> <span class="kw">[</span><span class="dv">0</span> <span class="kw">..</span> <span class="dv">16</span><span class="kw">]</span>
      <span class="kw">if</span> i <span class="kw">isnt</span> j
        list<span class="kw">.</span>push <span class="kw">[</span>i<span class="kw">,</span> j<span class="kw">]</span>

  rec <span class="kw">=</span> <span class="fu">(idx) -&gt;</span>
    <span class="kw">if</span> idx <span class="kw">&lt;</span> list<span class="kw">.</span>length
      <span class="kw">[</span>t<span class="kw">,</span> g<span class="kw">]</span> <span class="kw">=</span> list<span class="kw">[</span>idx<span class="kw">]</span>
      trade t<span class="kw">,</span> g<span class="kw">,</span> <span class="dv">0</span>
      <span class="ot">setTimeout</span> rec<span class="kw">,</span> time_lag<span class="kw">,</span> idx <span class="kw">+</span> <span class="dv">1</span>
  rec <span class="dv">0</span>

<span class="co"># ---- main</span>

<span class="kw">switch</span> process<span class="kw">.</span>argv<span class="kw">[</span><span class="dv">2</span><span class="kw">]</span>
  <span class="kw">when</span> <span class="st">&quot;-s&quot;</span>
    do loop_summon
  <span class="kw">when</span> <span class="st">&quot;-t&quot;</span>
    do loop_trade
  <span class="kw">when</span> <span class="st">&quot;-T&quot;</span>
    do seco_trade</code></pre>
<h3 id="ui.coffee">ui.coffee</h3>
<pre class="sourceCode coffee"><code class="sourceCode coffee">fs <span class="kw">=</span> require <span class="st">&#39;fs&#39;</span>
<span class="kw">{</span>exec<span class="kw">}</span> <span class="kw">=</span> require <span class="st">&#39;child_process&#39;</span>
ms <span class="kw">=</span> require <span class="st">&#39;./scores.json&#39;</span>
monsters <span class="kw">=</span> require <span class="st">&#39;./it.json&#39;</span>

curl <span class="kw">=</span> <span class="fu">(url, cont) -&gt;</span>
  exec <span class="st">&quot;curl \&#39;</span><span class="ch">#{</span>url<span class="ch">}</span><span class="st">\&#39; |nkf&quot;</span><span class="kw">,</span> <span class="fu">(err, out) -&gt;</span>
    <span class="kw">throw</span> err <span class="kw">if</span> err
    cont out <span class="kw">if</span> cont

URL <span class="kw">=</span> <span class="st">&quot;https://game.coderunner.jp/&quot;</span>
token <span class="kw">=</span> <span class="st">&#39;CDR2YBS99ZXWOQSQUERT71KL18ORJV6K&#39;</span>

ls <span class="kw">=</span> ms<span class="kw">.</span>map <span class="fu">(s, idx) -&gt;</span> <span class="kw">[</span>idx<span class="kw">,</span> s<span class="kw">]</span>
  <span class="kw">.</span>sort <span class="fu">(a, b) -&gt;</span> b<span class="kw">[</span><span class="dv">1</span><span class="kw">]</span> <span class="kw">-</span> a<span class="kw">[</span><span class="dv">1</span><span class="kw">]</span>
  <span class="kw">.</span>slice<span class="kw">(</span><span class="dv">0</span><span class="kw">,</span> <span class="dv">10</span><span class="kw">)</span>
  <span class="kw">.</span>map <span class="fu">(o) -&gt;</span> o<span class="kw">[</span><span class="dv">0</span><span class="kw">]</span>

<span class="ot">console</span><span class="kw">.</span>warn ms<span class="kw">.</span>slice<span class="kw">(</span><span class="dv">0</span><span class="kw">,</span><span class="dv">3</span><span class="kw">)</span>
<span class="ot">console</span><span class="kw">.</span>warn ls<span class="kw">.</span>slice<span class="kw">(</span><span class="dv">0</span><span class="kw">,</span><span class="dv">3</span><span class="kw">)</span>

<span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;div style=&#39;padding-top:60px;&#39;&gt;&quot;</span>
<span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;table&gt;&quot;</span>
<span class="kw">for</span> m<span class="kw">,</span> i <span class="kw">in</span> ms
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;tr&gt;&quot;</span>
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;td style=&#39;width:60px;&#39;&gt;</span><span class="ch">#{</span>i<span class="ch">}</span><span class="st">-th&lt;/td&gt;&quot;</span>
  <span class="kw">if</span> i <span class="kw">in</span> ls
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;td style=&#39;width:120px&#39;&gt;&lt;font color=red&gt;</span><span class="ch">#{</span>m<span class="ch">}</span><span class="st">&lt;/font&gt;&lt;/td&gt;&quot;</span>
  <span class="kw">else</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;td style=&#39;width:120px&#39;&gt;</span><span class="ch">#{</span>m<span class="ch">}</span><span class="st">&lt;/td&gt;&quot;</span>
  <span class="kw">for</span> k <span class="kw">in</span> monsters<span class="kw">[</span>i<span class="kw">].</span>required<span class="kw">[</span><span class="dv">17</span> <span class="kw">..</span> <span class="dv">24</span><span class="kw">]</span>
  <span class="co">#for k in monsters[i].required</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;td style=&#39;width:50px&#39;&gt;</span><span class="ch">#{</span>k<span class="ch">}</span><span class="st">&lt;/td&gt;&quot;</span>
  <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;/tr&gt;&quot;</span>
<span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;/table&gt;&quot;</span>
<span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;/div&gt;&quot;</span>

ami <span class="kw">=</span> <span class="fu">-&gt;</span>
  curl <span class="st">&quot;</span><span class="ch">#{</span>URL<span class="ch">}</span><span class="st">info.json?token=</span><span class="ch">#{</span>token<span class="ch">}</span><span class="st">&quot;</span><span class="kw">,</span> <span class="fu">(result) -&gt;</span>
    info <span class="kw">=</span> JSON<span class="kw">.</span>parse result
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;div style=&#39;position:fixed;left:0px;top:0px;background-color:white&#39;&gt;&quot;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;table&gt;&quot;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;tr&gt;&quot;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;td style=&#39;width:180px&#39;&gt;poss&lt;/td&gt;&quot;</span>
    <span class="kw">for</span> m<span class="kw">,</span> i <span class="kw">in</span> info<span class="kw">.</span>stone<span class="kw">[</span><span class="dv">17</span> <span class="kw">..</span> <span class="dv">24</span><span class="kw">]</span>
    <span class="co">#for m, i in info.stone</span>
      <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;td style=&#39;width:50px&#39;&gt;</span><span class="ch">#{</span>m<span class="ch">}</span><span class="st">&lt;/td&gt;&quot;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;/tr&gt;&quot;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;/table&gt;&quot;</span>
    <span class="ot">console</span><span class="kw">.</span>log <span class="st">&quot;&lt;/div&gt;&quot;</span>

do ami</code></pre>
<p><code>it.json</code> は、ゲーム開始時のモンスターの情報</p>
<p><a href="https://gist.github.com/cympfh/7aae1d6eaee1d00a86bd">https://gist.github.com/cympfh/7aae1d6eaee1d00a86bd</a></p>
</section>
<section>
<h1 id="年-11月29日-土曜日-20時26分03秒-jst">2014年 11月29日 土曜日 20時26分03秒 JST</h1>
<h3 id="家賃を振り込み忘れたこと">家賃を振り込み忘れたこと。</h3>
<h3 id="linux-debian-wheezy-で音楽cdを取り込んだこと">Linux (Debian wheezy) で音楽CDを取り込んだこと</h3>
<blockquote>
<p>結論: <code>Asunder</code>さんが良い</p>
</blockquote>
<p>初め、mplayer を用いて取り込もうとしたけど、 途中でEnterキーを押すと今の取り込んでるトラックを打ち切って 次に行ってしまうだという仕様に気づいて やめた。</p>
<p>これは、一応、 mplayerで通常通りに再生させて、 音楽の出力をスピーカーでなく wavファイルへの書き出しとしているだけなので、 仕方ない。</p>
<p>Linuxで完成度の高い音楽再生ソフトウェアといえば、 Ubuntuの経験から、 <code>Banshee</code> しか知らなかった。 しかしCDから取り込む際の 音楽情報付加がうまくいかなかった。 音楽情報を見つけられないみたいなことを言った。</p>
<p>ググると、 &quot;<code>sound-juicer</code> を使え。これでうまくいかなかったことはない&quot; みたいな書き込みがあったので、 入れてみた。</p>
<p><code>/dev/cdrw</code> を読んでくれず、 CDが見つからないと抜かした。</p>
<p>そのメッセージそのままググると、 &quot;僕はAsunderが好きだな&quot; という、解決策が載ってた。</p>
<p>直接の解決策じゃなくて、 別のソフトを紹介するだけという 先ほどと同じパターンだ。</p>
<figure>
<img src="img/141129.png" />
</figure>
<p>オプションでmp3を選択すると、 <code>lame</code>が見つからない、と怒られたので</p>
<pre class="sh"><code>sudo apt-get install lame</code></pre>
<p>これで問題なさそう。</p>
</section>
<section>
<h1 id="sat-nov-15-142123-jst-2014">Sat Nov 15 14:21:23 JST 2014</h1>
<p>人にただ従うのは気持ちの良いこと。<br>誰かに憧れてみてその人の行動パターンを真似することは気持ちの良いこと。</p>
<p>楽だし、 良い結果が出やすいとわかっているから。</p>
<p>彼が白色だと言うならば、 白色だと考えていたほうが後々納得するに違いないんだ。 私が勝手に憧れて勝手に模倣してる間はマシで、 ああしろこうしろと、指令をしだしてはもう信用できない。 もう24色全部使い尽くした。</p>
</section>
<section>
<h1 id="fri-nov-14-194623-jst-2014">Fri Nov 14 19:46:23 JST 2014</h1>
<p>時系列順に。</p>
<p>Richard Bird著 &quot;関数プログラミング: 珠玉のアルゴリズムデザイン&quot; が、2014/11/06 に出た。 つい先日購入し、今2章まで読んだ。 1章まで立ち読みしたが、 一番初めからさっそく難しい。 これは矢張り、ノートに手で書きながら、 確認しながら読むものらしい。</p>
<p>Twitter@fillos を、メモのためのアカウントとして作った。</p>
<p>交流を目的としない、 メモのためのtwitterは有意義である。</p>
<ul class="incremental">
<li>自動リンク付け</li>
<li>画像アップロード機能</li>
</ul>
<p>この2つだけなのだけれど。</p>
<p>何もフォローしないと、 誰かフォローしましょう！と文句が出るので、 東京メトロの交通情報を教えてくれるアカウントを、 東京メトロの線の数だけフォローしている。</p>
<p>Androidの上の手書きメモのためのアプリとして、 &quot;手書きメモアプリ　-kakikaki1.05-&quot; を使うことにした。</p>
<p>メモアプリ一つ見ても、 本当にAndroidアプリにはろくな物がない。 &quot;Google play&quot; の有用さとして、 登録されてあるアプリの数だけを見ても しょうがない。 碌でもないのが多すぎるのだ。</p>
<p>私が判断する録でもなさとは、</p>
<ul class="incremental">
<li>求める機能の少なさ</li>
<li>正しく動かない (bug)</li>
<li>不親切な設計 (取り返しのつかない操作の前には確認を促す)</li>
<li>広告の表示</li>
<li>無料であるかどうか</li>
<li>更新がなされるか (機能が今後追加されるか)</li>
</ul>
<p>後半については、 アプリの制作側が、 そのアプリだけでお金を儲けたいか、 という考えがあるので、 もちろん広告を見せることや、 また、一度リリースしたアプリはもう二度と更新しないか、 は、本来、制作側の自由である。 ただ使う側の人間が、あまり大きな声で言っていいものではない。</p>
<p>そこで、使う側の姿勢としては、 &quot;碌なものが無いのならば自分で作るしか無い&quot; ということである。 これについては、 今も検討している。</p>
</section>
<section>
<h1 id="年-11月13日-木曜日-12時01分27秒-jst">2014年 11月13日 木曜日 12時01分27秒 JST</h1>
<h2 id="夢日記">夢日記。</h2>
<p>経路に従って廻る大変狭い温泉に行った。 私だけ普段持ち歩いているカバンを持っていたのでお湯にどうやって入ろうと考えていた。 カバンを床に降ろして、 一番初めの温泉に入ったところ、 すぐ近所の家と隣接して丸見えなことに気がついた。 その男性は、なんだか笑いながら言い訳めいたことを言っていた。</p>
</section>
<section>
<h1 id="tue-nov-11-225544-jst-2014">Tue Nov 11 22:55:44 JST 2014</h1>
<p>こんな経験がないという人がいたら、 それは大変うらやましいことで、 でもなんだか、 そういう人の方が多いんじゃないかなって 思う。</p>
<p>昨日たくさん喋って、 仲良くなって、 すっかり友達だと思ってたのに、 今日会ったらヒトコトも話してくれなくて、 挨拶してくれなくて、 僕は必死に会釈くらいするのに、 それにも返してくれない。</p>
<p>人間は気まぐれだから。<br>「猫は気まぐれ」だと意味が随分違うね。</p>
<hr>
<p>絶対昔読んだことのある本に書いてあったはずなのに、 何も覚えてない。 読み方が悪いのだろうか。 でも、大事そうなところだけ拾い読みして、 結果何も残らないような読み方は癖で治らないだろう。</p>
<pre class="coffee"><code>stack = []

has_read (book) -&gt;
  stack.push book if valuable book

rec = -&gt;
  book = stack.shift()
  begin_read book, -&gt;
    has_read book
    do rec

do rec</code></pre>
</section>
<section>
<h1 id="mon-nov-3-131630-jst-2014">Mon Nov 3 13:16:30 JST 2014</h1>
<p>夢日記。</p>
<p>センター試験。 廊下は本棚で埋まっている。 自分の席は見つからない。 中学受験。 自分の机を見るとプログラミングの本があって、それで授業を受けている。 分解したボールペンを戻せないで次の授業を受けれない。 自分は一番前の席だった。</p>
</section>
<section>
<h1 id="fri-oct-31-082202-jst-2014">Fri Oct 31 08:22:02 JST 2014</h1>
<p>自分のブログの中を検索するのに普通にgrepでやってたけど、 それじゃなんだから、 <a href="http://cympfh.github.io/taglibro/filter/">http://cympfh.github.io/taglibro/filter/</a> としてみた。</p>
<p>実装は <a href="http://cympfh.github.io/tools/neta/">http://cympfh.github.io/tools/neta/</a> と全く同じ。 今回は、記事の中の名詞だけを抜き出してきて、検索対象にした。</p>
</section>
<section>
<h1 id="mon-oct-27-070347-jst-2014">Mon Oct 27 07:03:47 JST 2014</h1>
<h2 id="プロコンに向けた-makefile">プロコンに向けた Makefile</h2>
<p>10分程で今書いたものなので使い勝手は分からない。</p>
<pre class="make"><code>all: main.exe input_
    ./main.exe &lt; input | tee out

main.exe: main.cc
    g++ -o $@ -std=c++11 $^

input_:
    xsel -bo | sed -e &#39;s/^\s*//g&#39; | sed -e &#39;s/\s*$$//g&#39; &gt; input

test: main.exe
    @for i in cases/*.in; do \
        ./main.exe &lt; $$i &gt; /tmp/out; \
        cmp -s /tmp/out $${i%in}out; \
        RETVAL=$$?; \
        if [  $$RETVAL -eq 1 ]; then \
        /bin/echo -e &#39;\e[31m&#39;$$i&#39;\e[m&#39;; \
        diff /tmp/out $${i%in}out; \
        exit 1; \
        fi; \
        done; \
        /bin/echo -e &#39;\e[34mpassed!\e[m&#39;


clean:
    -mkdir cases
    -rm -f out *.exe cases/* /tmp/out</code></pre>
<ol class="incremental" type="1">
<li>main.cc を書く</li>
<li>入力を一つ、コピペした状態で <code>make</code>
<ul class="incremental">
<li>xselを使って、クリップボードの中身を<code>./input</code>とする</li>
<li>出力は <code>./out</code> に tee する</li>
</ul></li>
<li>ひとつずつ、<code>cases/xxx.in</code> と <code>cases/xxx.out</code> を用意して <code>make test</code></li>
<li><code>make clean</code> は、cases/ の中身を吹き飛ばす
<ul class="incremental">
<li>cases/ が無かったらここで作るよう、初期化も兼ねてる</li>
</ul></li>
</ol>
<hr>
<p>シェルスクリプトをMakefileの中に書くのがすごい苦手で、 行頭に <code>@</code> を置く方法と、 echo を絶対パスで指定するのを知った。 素でechoするとmakeの組み込みか何かが働く？かでオプションを理解してくれない。</p>
</section>
<section>
<h1 id="sat-oct-25-020422-jst-2014">Sat Oct 25 02:04:22 JST 2014</h1>
<p><a href="https://github.com/twitter/twurl">twitter/twurl</a> を使って一括スパム報告</p>
<p>よくわかんないんだけど、 アニメ公式アカウント関連ばっかりフォローすると、 胡散臭いアカウントに大量にフォローされる。</p>
<p>&quot;@{anime title}fan&quot; というIDで何かの宣伝しつつ、 特定の作品の画像を貼るみたいな、 明らかに同じ人たちが作っていて、 &quot;@sarbantfan&quot; なんかを見ると、 怪しいurlを貼るわけでもなく、 怪しい商品の宣伝をするわけもないし。</p>
<p>それはともかく、 はじめは一人ひとりスパム報告してたんだけど、 ちょっと忘れてたらもうweb上でそれをやるには面倒すぎる量になってた。 目方で量ると、フォロワ160人のほとんど半分がスパムだった。</p>
<pre class="sh"><code>$ twurl accounts
ampeloss
  qnLRwkeo8zFjhIDfgG0F8Q
cympfh
  qnLRwkeo8zFjhIDfgG0F8Q (default)
unddich
  qnLRwkeo8zFjhIDfgG0F8Q</code></pre>
<p>jsonなので, <a href="http://stedolan.github.io/jq/">jq</a> も使う。</p>
<p>フォロワの取得 (max 200 at a time)</p>
<pre class="sh"><code>$ twurl -X GET /1.1/followers/list.json?count=200 | jq -r &#39;.users[].screen_name&#39; &gt; /tmp/ids</code></pre>
<p>スパムしたい方がそうでないより少ないとして、</p>
<pre class="sh"><code>$ cp /tmp/ids /tmp/ids0
$ vim /tmp/ids
(スパムしたいアカウントの行を消す)
$ diff /tmp/ids0 /tmp/ids | grep &#39;^&lt;&#39; | sed &#39;s/^..//g&#39; &gt; /tmp/list</code></pre>
<p><code>/tmp/list</code> が最終的に消したい人たち.<br>漏れがあると嫌なので、スパムの数を数えておいて、 予め、頭の中で引き算しておく。</p>
<pre class="sh"><code>$ wc -l /tmp/list
81 /tmp/list</code></pre>
<p>これに対して /users/report_spam を叩きたいんだけど、 他同様、使用制限があるらしい。 でも、 https://dev.twitter.com/rest/public/rate-limits には載っていない。 素敵だ。</p>
<p>素敵なことは無視しよう。</p>
<pre class="sh"><code>$ cat /tmp/list | xargs -i twurl -X POST -d screen_name={} /1.1/users/report_spam.json</code></pre>
<p>すぐに、 <code>javascript {&quot;errors&quot;:[{&quot;code&quot;:205,&quot;message&quot;:&quot;You are over the limit for spam reports.&quot;}]}</code> を返してきた。 ほとんど一度に、このAPIを叩けるのは 65 回らしい。</p>
<p>1 window は 15分らしいので、</p>
<pre class="sh"><code>$ tail -n `expr 81 - 65` /tmp/list &gt; /tmp/list_rest
$ sleep 15m &amp;&amp; cat /tmp/list_rest | xargs -i twurl -X POST -d screen_name={} /1.1/users/report_spam.json</code></pre>
<p>として寝ます。<br>おやすみなさい。</p>
</section>
<section>
<h1 id="fri-oct-24-020751-jst-2014">Fri Oct 24 02:07:51 JST 2014</h1>
<h2 id="in-c-addon-アドオン-on-node.js-processing-the-utf8-or-unicode-string">In c++ addon (アドオン) on node.js, processing the utf8 (or unicode?) string</h2>
<ul class="incremental">
<li><a href="https://github.com/cympfh/pattern-language">cympfh/pattern-language</a></li>
<li>問題のcode
<ul class="incremental">
<li><a href="https://github.com/cympfh/pattern-language/blob/master/mcp.coffee">coffee版</a></li>
<li><a href="https://github.com/cympfh/pattern-language/blob/master/mcp/mcp.cc">c++版</a></li>
</ul></li>
</ul>
<p>極小共通汎化を解く必要があって, 最長共通部分文字列のあの, O(mn)でやるDPと全く同様に解けた. これがめっちゃ遅くって, C++で書き直してた.</p>
<p>で, nodeが扱う文字列は無条件でutf-8 である. c++の内部でも, それをそのように扱う必要がある.</p>
<ul class="incremental">
<li>ref; <a href="http://izs.me/v8-docs/classv8_1_1String.html">v8: v8::String Class Reference</a></li>
</ul>
<p>まったく、APIの名前が紛らわしい。 <code>Write</code> という名前も、<code>WriteUtf8</code> という名前も。</p>
<p>今回、私が新しく学んだAPIについてのみ書く。</p>
<h1 id="型チェック">型チェック</h1>
<pre class="sourceCode cpp"><code class="sourceCode cpp">v8::Value::IsString()

<span class="co">// Arguments&amp; args</span>
args[<span class="dv">0</span>]-&gt;IsString();</code></pre>
<h1 id="v8string-へのキャスト-objecttostring">v8::String へのキャスト (Object#toString)</h1>
<pre class="sourceCode cpp"><code class="sourceCode cpp">v8::Value::ToString()

<span class="co">// Arguments&amp; args</span>
Local&lt;String&gt; str = args[<span class="dv">0</span>]-&gt;ToString();</code></pre>
<h1 id="文字列長さの取得-stringlength">文字列長さの取得 (String#length)</h1>
<pre class="sourceCode cpp"><code class="sourceCode cpp">v8::Value::Length()

<span class="co">// Arguments&amp; args</span>
<span class="dt">int</span> n = args[<span class="dv">0</span>]-&gt;Length();</code></pre>
<p>変換をする前に、 <code>String#length</code> で長さを取得する必要がある。</p>
<h1 id="c-プリミティブ型へのキャスト">c++ プリミティブ型へのキャスト</h1>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// Local&lt;String&gt; str</span>
<span class="dt">int</span> n = str-&gt;Length();
<span class="dt">uint16_t</span> s[n];
str-&gt;Write(s);</code></pre>
<p><code>Write</code> はいわゆる <code>sprinf</code> である。 また、<code>WriteAscii</code> と、 <code>WriteUtf8</code> もあるが、 今は使いどきではない。</p>
<h1 id="c-プリミティブ型から-javascript-文字列へのキャスト">c++ プリミティブ型から javascript 文字列へのキャスト</h1>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="dt">uint16_t</span> s[<span class="dv">14</span>];
<span class="co">// assign into s[0] to s[12]</span>
s[<span class="dv">13</span>] = <span class="dv">0</span>; <span class="co">// last must be &#39;\n&#39;</span>
Local&lt;String&gt; str = String::New(us));</code></pre>
</section>
<section>
<h1 id="wed-oct-22-011359-jst-2014">Wed Oct 22 01:13:59 JST 2014</h1>
<p>2つの素数に素因数分解済みの公開鍵を渡されて、<br>RSA暗号を解読しろっていう問題。</p>
<script src="https://gist.github.com/cympfh/f471d36dfbb4bc184c18.js"></script>

<p>Common Lisp で実装したやつはなぜか正しく動かなかった。<br>もう分かんない。<br>R5RSさん大好き</p>
</section>
<a href='./index.html'>▷ read more</a>
