<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="../../css/h1.css">
</head>
<body>
<h1 id="年-6月-1日-日曜日-125520-jst">2014年 6月 1日 日曜日 12:55:20 JST</h1>
<h2 id="vim-vimclient-びるどおぷしょん">vim +vimclient (びるどおぷしょん)</h2>
<p>vimclient 機能を知ったのでメモを．</p>
<ul class="incremental">
<li>in a Terminal</li>
</ul>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">vim</span> --servername VS</code></pre>
<p>VS はユニークにユーザーが与える文字列． <code>vim server</code> の頭文字のつもり．</p>
<ul class="incremental">
<li>in another Terminal</li>
</ul>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">vim</span> --servername VS --remote-send <span class="st">&quot;&lt;esc&gt;&lt;esc&gt;iHello, VS. Do you read this?&quot;</span></code></pre>
<p>--remote-send で与えた文字列を、<code>VS</code>と名のついた vim で、 忠実に、キーストロークを再現してくれる． ここでvim特有のキー表記、<esc> だとか <cr> だとか <C-n> だとか が効く．</p>
<p>今の場合、</p>
<pre class="vim"><code> &quot;&lt;esc&gt;&lt;esc&gt;iHello, VS. Do you read this?&quot;</code></pre>
<p>これを送信した． 頭の <code>&quot;&lt;esc&gt;&lt;esc&gt;i&quot;</code>で確実に挿入モードに移行して、 その状態で文字列を入力する． 最後にノーマルモードに戻ることをしていない．</p>
<p><code>:help</code> には、ノーマルモードへの移行には</p>
<pre class="vim"><code>&lt;C-\&gt;&lt;C-n&gt;</code></pre>
<p>を使おうと、書いてあった． 理由は、<code>&lt;esc&gt;</code> だと、ビープ音がなったり、画面のなんていうのかあのぴかっってやつ、一瞬白くなるやつ、あれがあるように設定してる人もいるから．それにしても、<code>&lt;c-\&gt;&lt;c-n&gt;</code> なんて初めてみた．確かに今、挿入モードやコマンドモードでこれを打ってみると、ノーマルに移行できた．</p>
<p>ノーマルモードへの移行は、頭ですることにしよう．</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">for</span> <span class="kw">i</span> in <span class="kw">`seq</span> 1 10<span class="kw">`;</span> <span class="kw">do</span> <span class="kw">vim</span> --servername VS --remote-send <span class="st">&quot;&lt;esc&gt;&lt;esc&gt;:insert&lt;cr&gt;</span><span class="ot">${i}</span><span class="st">&lt;cr&gt;.&quot;</span><span class="kw">;</span> <span class="kw">done</span></code></pre>
<p><code>:insert</code> コマンドの存在は知ってたけど、実際に使ったのは初めてだ．</p>
<pre class="vim"><code>:insert&lt;cr&gt;hoge&lt;cr&gt;fuga&lt;cr&gt;.&lt;cr&gt;</code></pre>
<p>と使うものらしい． へぇ．</p>
<h2 id="活用例">活用例</h2>
<p>この機能、いかに活用すれば私の人生が幸福になるものか．</p>
<p>ちょっと思いつかなかった．</p>
<p>普通に考えれば、 ユーザーがvimを開き、それを見てそれを操作してる場面で、裏から別のプロセスがそのvimに操作を加えることになりそう． つまり、ユーザー側がサーバ． 自分が見てるものが突然、挿入モードに入ったりなんだったりしたら迷惑でしかない．</p>
<p>だから私が考えたのは、ユーザーはそのvimで文書の編集をする機会は2割以下で、ほかはただ、見るだけ．例えば、Twitterをvim上に実現するみたいに．</p>
<h2 id="実際例">実際例</h2>
<p>実際に使われてる例をまず見るのが一番だった． 実は、<code>vmail</code>に使われている．</p>
<p>vim で gmail を見たり、送受信したりできるよ！っていう 謳い文句だけど、vimと言いながら <code>gem install</code> させるじゃねーかと 思ってたんだけど、 vim単体で実現するのが面倒そうなこと（きっとメールの送受信部分だろう） は、Rubyで実現して、vimはユーザーインターフェースであり、インターフェースへの反映に使ってると見た．</p>
<p><a href="https://github.com/danchoi/vmail/search?q=servername&amp;ref=cmdform">Search Results</a></p>
</body>
</html>
