<head>
<meta charset="UTF-8">
<title>YTl ver 1.4.0</title>
<link rel="stylesheet" type="text/css" href="./player.css">
<script type="text/javascript" src="../js/swfobject.js"></script>
<script type="text/javascript" src="./video.js"></script>
<script type="text/javascript" src="./playlist.js"></script>
<script type="text/javascript">

var ls, idx;

function listset() {

  var ids = 
    T.value.split('\n')
     .filter(function(l){ return (l.trim())[0] !== '#' })
     .filter(function(l){ return l.length >= 3 && l.indexOf(' ') > 0 })
     .map(function(l) {
        var i = l.indexOf(' ');
        return { id : l.slice(0, i) , name : l.slice(i+1) } })
     ;

  if (R.checked) ids = shuffle(ids);

  draw(ids);

  // where
  function shuffle(ls) {
    return ls.map(function(x){return [x,Math.random()]})
             .sort(function(x,y){return x[1]-y[1]})
             .map(function(x){return x[0]})
  }
}

var log0;

function ytExit() {
  idx = -1;
  setTitle();
  D.removeChild(player);
  var v = document.createElement("div");
  v.id = "V";
  v.width = "640px";
  v.height = "0px";
  D.appendChild(v);
  P.style.display = "block";
  log.innerHTML = log0;
}

function init() {

  log0 = log.innerHTML;

  pls.onchange = function(e) {
    load_pls(T, e.currentTarget.value);
  }
  init_pls(T, pls, location.search);

}

</script>
</head>
<body onload='init()'>

<div style="width:450px;display:block" id="D">
<div id="W">push ``play''</div>
<embed id='V' width='640px' height='0px' src=''>
</div>

<div id='P'>
  <form style='height:100%;width:450px'>
  <textarea wrap="off" id='T'># my playlist</textarea>
  <br>

  <select id='pls'></select>
  <input type='checkbox' id='R'> random
  <input type='button' value='play' onclick='listset()'>

  </form>
</div>
<code id='log'>
ver 1.4.0 : 2014/01/28 : location.search accesses the playlist
ver 1.3.2 : 2014/01/28 : playlists, recently changed order
ver 1.3.0 : 2014/01/24 : load a playlist
ver 1.2.4 : 2014/01/24 : adjust for Chrome
ver 1.2.3 : 2014/01/21 : add exit button
ver 1.2.2 : 2014/01/20 : loop in default
</code>
